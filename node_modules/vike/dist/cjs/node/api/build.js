"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.build = build;
const prepareViteApiCall_js_1 = require("./prepareViteApiCall.js");
const vite_1 = require("vite");
/**
 * Programmatically trigger `$ vike build`
 *
 * https://vike.dev/api#build
 */
async function build(options = {}) {
    const { viteConfigFromUserEnhanced } = await (0, prepareViteApiCall_js_1.prepareViteApiCall)(options, 'build');
    // Pass it to vike:build:pluginBuildApp
    if (viteConfigFromUserEnhanced)
        viteConfigFromUserEnhanced._viteConfigFromUserEnhanced = viteConfigFromUserEnhanced;
    const builder = await (0, vite_1.createBuilder)(viteConfigFromUserEnhanced);
    // buildApp() is implemented by vike:build:pluginBuildApp
    await builder.buildApp();
    return {
    /* We don't return `viteConfig` because `viteConfigFromUserEnhanced` is `InlineConfig` not `ResolvedConfig`
    viteConfig: viteConfigFromUserEnhanced,
    */
    };
}
